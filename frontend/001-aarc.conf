<VirtualHost *:80>

	ServerAdmin webmaster@localhost
	ServerName www.aarc.com
        ServerAlias aarc.com
	Redirect permanent / https://172.28.108.126/ 


	ErrorLog ${APACHE_LOG_DIR}/aarc_error.log
	CustomLog ${APACHE_LOG_DIR}/aarc_access.log combined
  
        <IfModule mod_cache.c>
	# checks if mod_cache is enabled
  CacheQuickHandler off
  CacheLock on
	#prevents multiple requests to the same uncached resource
  CacheLockPath /tmp/mod_cache-lock
	#temp file for CacheLock
  CacheIgnoreHeaders Set-Cookie
	#Set-Cookie can sometimes prevent caching


  <IfModule mod_cache_disk.c>
    CacheRoot /var/cache/apache2/mod_cache_disk  
# directory for cached files  
    CacheEnable disk /search.php                                                                                                                           # tells apache which URLs should be cached
    CacheDefaultExpire 3600  
 # 1 hour
    CacheMaxExpire 86400     
 # 1 day
    CacheHeader on            # enables X-Cache/Age headers
  </IfModule>
</IfModule>


<IfModule mod_headers.c>
        <Files "search.php">
    Header unset Set-Cookie
    Header set Cache-Control "max-age=3600, public"
    Header unset Pragma
	# Pragma is an older caching behavior; tells browsers to “not cache response; grab a fresh copy”
    Header unset Expires
	#not sure is this is necessary yet. Expires header might conflict with Cache-Control supposedly.

    # optional: add X-Cache fallback just in case(mod_cache will override when HIT)
    # Header set X-Cache "MISS" env=!CACHE_HIT
   # Header set X-Cache "HIT" env=CACHE_HIT

   #https://www.digitalocean.com/community/tutorials/how-to-create-a-self-signed-ssl-certificate-for-apache-in-ubuntu-22-04
   #https://www.atlantic.net/dedicated-server-hosting/how-to-create-and-install-a-self-signed-ssl-certificate-on-ubuntu/


        </Files>                                                                                                                                            </IfModule>
</VirtualHost>



<IfModule mod_ssl.c>
<VirtualHost _default_:443>
ServerAdmin webmaster@localhost
ServerName 172.28.108.126
DocumentRoot /var/www/aarc

ErrorLog ${APACHE_LOG_DIR}/error.log
CustomLog ${APACHE_LOG_DIR}/access.log combined

SSLEngine on
SSLCertificateFile /etc/ssl/certs/apache-selfsigned.crt
SSLCertificateKeyFile /etc/ssl/private/apache-selfsigned.key



</VirtualHost>
</IfModule>
