i dont think this is necessary ugh sorry

sudo apt install php-curl

sudo a2enmod cache
sudo a2enmod cache_disk
sudo a2enmod headers
*(installs necessary folders for mod_cache)*

sudo systemctl restart apache2
sudo systemctl start apache-htcacheclean

sudo nano /etc/apache2/sites-available/001-aarc.conf

*(Inside the <VirtualHost *:80> block, add:)*

<IfModule mod_cache.c>
	# checks if mod_cache is enabled
  CacheQuickHandler off
  CacheLock on
	#prevents multiple requests to the same uncached resource
  CacheLockPath /tmp/mod_cache-lock
	#temp file for CacheLock
  CacheIgnoreHeaders Set-Cookie
	#Set-Cookie can sometimes prevent caching


  <IfModule mod_cache_disk.c>
    CacheRoot /var/cache/apache2/mod_cache_disk  
# directory for cached files  
    CacheEnable disk /search.php
	# tells apache which URLs should be cached
    CacheDefaultExpire 3600  
 # 1 hour
    CacheMaxExpire 86400     
 # 1 day
    CacheHeader on            # enables X-Cache/Age headers
  </IfModule>
</IfModule>


<IfModule mod_headers.c>
        <Files "search.php">
    Header unset Set-Cookie
    Header set Cache-Control "max-age=3600, public"
    Header unset Pragma
	# Pragma is an older caching behavior; tells browsers to “not cache response; grab a fresh copy”
    Header unset Expires
	#not sure is this is necessary yet. Expires header might conflict with Cache-Control supposedly.

    # optional: add X-Cache fallback just in case(mod_cache will override when HIT)
    # Header set X-Cache "MISS" env=!CACHE_HIT
   # Header set X-Cache "HIT" env=CACHE_HIT

        </Files>
</IfModule>



sudo systemctl restart apache2

*(to test it if it works:)*
curl -I http://127.0.0.2/search.php?type=title&query=tolkien

(to check cache)
sudo ls /var/cache/apache2/mod_cache_disk/DZ/

***NOTE*** *cache is NOT easily readable, which is why it might be better to use cURL -I to test if X-Cache is a HIT or a MISS*

***NOTE*** Each unique url (?query=tolkien or ?query=harry+potter) is one cache entry.*
